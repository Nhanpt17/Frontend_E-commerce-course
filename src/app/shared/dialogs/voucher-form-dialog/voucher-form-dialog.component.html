<!-- voucher-form-dialog.component.html -->
<h1 mat-dialog-title>
  {{ isEditMode ? 'Chỉnh sửa Voucher' : 'Thêm Voucher Mới' }}
</h1>

<div mat-dialog-content [formGroup]="voucherForm">
  <mat-form-field appearance="outline" class="full-width" style="margin-top: 5px;">
    <mat-label>Mã Voucher</mat-label>
    <input matInput formControlName="code" required>
    <mat-error *ngIf="voucherForm.get('code')?.hasError('required')">
      Vui lòng nhập mã voucher
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Mô tả</mat-label>
    <textarea matInput formControlName="description" rows="3"></textarea>
  </mat-form-field>

  <div class="row">
    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Loại giảm giá</mat-label>
      <mat-select formControlName="discountType">
        <mat-option *ngFor="let type of discountTypes" [value]="type.value">
          {{ type.display }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Giá trị giảm</mat-label>
      <input matInput type="number" formControlName="discountValue" required>
      <span matSuffix *ngIf="voucherForm.get('discountType')?.value === 'PERCENTAGE'
                            ||voucherForm.get('discountType')?.value === 'SHIPPING_PERCENTAGE'">%</span>
      <span matSuffix *ngIf="voucherForm.get('discountType')?.value === 'FIXED_AMOUNT'">đ</span>
      <mat-error *ngIf="voucherForm.get('discountValue')?.hasError('required')">
        Vui lòng nhập giá trị
      </mat-error>
      <mat-error *ngIf="voucherForm.get('discountValue')?.hasError('min')">
        Giá trị phải lớn hơn 0
      </mat-error>
      <mat-error *ngIf="voucherForm.get('discountValue')?.hasError('max')">
        Phần trăm không vượt quá 100%
      </mat-error>
    </mat-form-field>
  </div>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Giá trị đơn hàng tối thiểu</mat-label>
    <input matInput type="number" formControlName="minimumOrderValue">
    <span matSuffix>đ</span>
  </mat-form-field>

  <div class="row">
    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Ngày bắt đầu</mat-label>
      <input matInput [matDatepicker]="startPicker" formControlName="startDate">
      <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
      <mat-datepicker #startPicker></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Ngày kết thúc</mat-label>
      <input matInput [matDatepicker]="endPicker" formControlName="endDate">
      <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
      <mat-datepicker #endPicker></mat-datepicker>
    </mat-form-field>
  </div>

  <div class="row">
    <mat-form-field appearance="outline" class="half-width">
      <mat-label>Số lượt sử dụng tối đa</mat-label>
      <input matInput type="number" formControlName="maxUsage">
      <mat-hint>Để trống nếu không giới hạn</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="half-width" *ngIf="voucherForm.get('public')?.value">
      <mat-label>Điểm yêu cầu</mat-label>
      <input matInput type="number" formControlName="pointsRequired" required>
      <mat-error *ngIf="voucherForm.get('pointsRequired')?.hasError('required')">
        Vui lòng nhập điểm yêu cầu
      </mat-error>
    </mat-form-field>
  </div>

  <div class="row">

    <mat-slide-toggle formControlName="public" color="primary" class="toggle-margin">
      Loại Voucher: {{ voucherForm.get('public')?.value ? 'Public' : 'Private' }}
    </mat-slide-toggle>
  </div>
</div>

<div mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Hủy</button>
  <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="voucherForm.invalid">
    {{ isEditMode ? 'Cập nhật' : 'Thêm mới' }}
  </button>
</div>